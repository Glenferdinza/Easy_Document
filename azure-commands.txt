# Azure Cloud Shell Commands for Compress_Img Deployment
# Copy and paste these commands one by one in your Azure Cloud Shell

# 1. Set variables
$resourceGroup = "compress-img-rg"
$appName = "compress-img-app"
$location = "eastus"
$repoUrl = "https://github.com/Glenferdinza/composser_compress-convert-file.git"

# 2. Create resource group
az group create --name $resourceGroup --location $location

# 3. Create App Service Plan (Free F1 tier)
az appservice plan create --name "$appName-plan" --resource-group $resourceGroup --sku F1 --is-linux

# 4. Create Web App with Python runtime
az webapp create --resource-group $resourceGroup --plan "$appName-plan" --name $appName --runtime "PYTHON|3.12"

# 5. Configure deployment from GitHub
az webapp deployment source config --resource-group $resourceGroup --name $appName --repo-url $repoUrl --branch main --manual-integration

# 6. Set environment variables
az webapp config appsettings set --resource-group $resourceGroup --name $appName --settings DJANGO_SETTINGS_MODULE=backend.settings PYTHONPATH=/home/site/wwwroot WEBSITES_PORT=8000 DEBUG=False

# 7. Set startup command
az webapp config set --resource-group $resourceGroup --name $appName --startup-file "python backend/manage.py runserver 0.0.0.0:8000"

# 8. Get the app URL
Write-Host "Deployment completed! Your app will be available at: https://$appName.azurewebsites.net"
